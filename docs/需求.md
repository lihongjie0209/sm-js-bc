
使用typescript实现SM2、SM3和SM4算法


## 技术栈
- TypeScript
- tsdown


## 要求
- 按照java代码 data/bc-java 一比一复刻
- 只需要实现bc-java 的底层实现，不需要实现java的api
- 代码风格和命名规范参考java代码
- 代码注释参考java代码
- 只可以使用import/export 语法，不可以使用require/module.exports


## 算法范围

### SM2（椭圆曲线公钥密码算法）
- SM2 数字签名
- SM2 公钥加密
- SM2 密钥交换

### SM3（密码杂凑算法）
- SM3 消息摘要
- 基于 SM3 的 HMAC
- 基于 SM3 的 KDF（密钥派生函数）

### SM4（分组密码算法）
- SM4 基础加密引擎
- SM4 工作模式：
  - ECB（电子密码本模式）
  - CBC（密码分组链接模式）
  - CTR（计数器模式）
  - GCM（伽罗瓦/计数器模式）
  - CFB（密文反馈模式）
  - OFB（输出反馈模式）
- SM4 填充方案：
  - PKCS7Padding
  - NoPadding
  - ZeroPadding


## 开发流程
1. 自底向上开发 - 先实现基础设施模块（摘要算法基础设施、椭圆曲线基础设施、分组密码基础设施、工具类和异常处理），再实现核心算法模块（SM3、SM2签名、SM2加密、SM2密钥交换、SM4）
2. 每个模块实现后编写单元测试，确保功能正确
3. 只有在底层模块完全实现并测试通过后，才能开始上层模块的开发
4. 组件的接口应该和bc-java 保持一致，确保互操作性
5. 编写单元测试之前先在bc-java中查找是否有对应的测试用例，作为参考


## SM4 实现优先级

### 第一阶段：核心引擎
1. **SM4Engine** - 基础加密引擎
   - 参考：`org.bouncycastle.crypto.engines.SM4Engine`
   - 实现 128 位密钥的 SM4 分组密码
   - 支持 16 字节块的加密和解密

### 第二阶段：工作模式（按优先级）
1. **ECB 模式** - 最简单的模式，适合测试
2. **CBC 模式** - 最常用的模式
3. **CTR 模式** - 流密码模式
4. **GCM 模式** - 认证加密模式（AEAD）
5. **CFB/OFB 模式** - 流密码模式变体

### 第三阶段：填充方案
1. **PKCS7Padding** - 标准填充
2. **NoPadding** - 无填充（用户自行处理）
3. **ZeroPadding** - 零填充

### 第四阶段：高级功能
1. **KeyParameter** - 密钥参数封装
2. **ParametersWithIV** - 带初始化向量的参数
3. **BufferedBlockCipher** - 缓冲块密码包装器
4. **高级 API** - 类似 SM2 的便捷接口