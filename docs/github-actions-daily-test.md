# GitHub Actions æ¯æ—¥å…¨é‡æµ‹è¯•

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®é…ç½®äº†è‡ªåŠ¨åŒ–çš„æ¯æ—¥å…¨é‡æµ‹è¯• GitHub Workflowï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œè·¨å¹³å°å…¼å®¹æ€§ã€‚

## â° è¿è¡Œæ—¶é—´

- **è‡ªåŠ¨è¿è¡Œ**: æ¯å¤©å‡Œæ™¨ 2:00 (UTC) / ä¸Šåˆ 10:00 (åŒ—äº¬æ—¶é—´)
- **æ‰‹åŠ¨è§¦å‘**: å¯åœ¨ GitHub Actions é¡µé¢æ‰‹åŠ¨è¿è¡Œ
- **Push è§¦å‘**: æ¨é€åˆ° main/master åˆ†æ”¯æ—¶è‡ªåŠ¨è¿è¡Œ

## ğŸ§ª æµ‹è¯•å†…å®¹

### 1. JavaScript å•å…ƒæµ‹è¯•
- **æµ‹è¯•æ•°é‡**: 614+ æµ‹è¯•ç”¨ä¾‹
- **è¿è¡Œç¯å¢ƒ**: Node.js 20.x å’Œ 22.x
- **æµ‹è¯•å†…å®¹**:
  - SM2/SM3/SM4 ç®—æ³•å®ç°
  - åŠ å¯†æ¨¡å¼ï¼ˆECB/CBC/CTR/GCM/OFB/CFBï¼‰
  - æ•°å­¦è¿ç®—å’Œæ¤­åœ†æ›²çº¿
  - å·¥å…·å‡½æ•°å’Œå‚æ•°ç±»
- **ä»£ç è¦†ç›–ç‡**: è‡ªåŠ¨ç”Ÿæˆå¹¶ä¸Šä¼ åˆ° Codecov

### 2. Java é›†æˆæµ‹è¯•
- **æµ‹è¯•æ•°é‡**: 141+ æµ‹è¯•ç”¨ä¾‹
- **è¿è¡Œç¯å¢ƒ**: JDK 17 å’Œ JDK 21
- **æµ‹è¯•å†…å®¹**:
  - JavaScript â†” Java äº’æ“ä½œæ€§
  - SM2 ç­¾å/åŠ å¯†å…¼å®¹æ€§
  - SM4 åŠ å¯†è§£å¯†å…¼å®¹æ€§
  - è·¨è¯­è¨€æ•°æ®ä¸€è‡´æ€§
- **æµ‹è¯•æ¡†æ¶**: JUnit 5 + GraalVM Polyglot

### 3. å®Œæ•´æµ‹è¯•å¥—ä»¶
- **è¿è¡Œç¯å¢ƒ**: GraalVM 21
- **æ‰§è¡Œå‘½ä»¤**: `npm run test:all`
- **åŒ…å«å†…å®¹**:
  - æ‰€æœ‰ JavaScript æµ‹è¯•
  - æ‰€æœ‰ Java é›†æˆæµ‹è¯•
  - ç«¯åˆ°ç«¯æµ‹è¯•
- **è¶…æ—¶é™åˆ¶**: 30 åˆ†é’Ÿ

## ğŸ“Š æµ‹è¯•çŸ©é˜µ

| æµ‹è¯•ç±»å‹ | ç¯å¢ƒ | æµ‹è¯•æ•°é‡ | é¢„æœŸæ—¶é—´ |
|---------|------|---------|---------|
| JavaScript å•å…ƒæµ‹è¯• | Node.js 20.x | 614+ | ~3 ç§’ |
| JavaScript å•å…ƒæµ‹è¯• | Node.js 22.x | 614+ | ~3 ç§’ |
| Java é›†æˆæµ‹è¯• | JDK 17 | 141+ | ~30 ç§’ |
| Java é›†æˆæµ‹è¯• | JDK 21 | 141+ | ~30 ç§’ |
| å®Œæ•´æµ‹è¯•å¥—ä»¶ | GraalVM 21 | 755+ | ~2 åˆ†é’Ÿ |

## ğŸ”„ å·¥ä½œæµç¨‹

```mermaid
graph TD
    A[å®šæ—¶è§¦å‘/æ‰‹åŠ¨è§¦å‘/Push] --> B[JavaScript Tests]
    B --> C[Java Integration Tests]
    B --> D[Full Test Suite]
    C --> E[Notify Results]
    D --> E
    E --> F{æ‰€æœ‰æµ‹è¯•é€šè¿‡?}
    F -->|æ˜¯| G[âœ… æˆåŠŸ]
    F -->|å¦| H[âŒ å¤±è´¥å¹¶é€šçŸ¥]
```

## ğŸ“ ç”Ÿæˆçš„äº§ç‰©

### æµ‹è¯•æŠ¥å‘Š
- **JavaScript è¦†ç›–ç‡**: ä¸Šä¼ åˆ° Codecov
- **Java æµ‹è¯•ç»“æœ**: Surefire æŠ¥å‘Š
- **ä¿ç•™æ—¶é—´**: 7 å¤©

### ä¸‹è½½äº§ç‰©
åœ¨ GitHub Actions é¡µé¢å¯ä»¥ä¸‹è½½ï¼š
- `java-test-results-jdk17` - JDK 17 æµ‹è¯•ç»“æœ
- `java-test-results-jdk21` - JDK 21 æµ‹è¯•ç»“æœ
- `full-test-results` - å®Œæ•´æµ‹è¯•ç»“æœå’Œè¦†ç›–ç‡

## ğŸš€ æ‰‹åŠ¨è§¦å‘

### é€šè¿‡ GitHub ç½‘é¡µ
1. è®¿é—®ä»“åº“çš„ Actions é¡µé¢
2. é€‰æ‹© "Daily Full Test Suite" workflow
3. ç‚¹å‡» "Run workflow" æŒ‰é’®
4. é€‰æ‹©åˆ†æ”¯ï¼ˆé»˜è®¤ masterï¼‰
5. ç‚¹å‡» "Run workflow" ç¡®è®¤

### é€šè¿‡ GitHub CLI
```bash
gh workflow run daily-full-test.yml
```

## ğŸ”§ é…ç½®è¯´æ˜

### Workflow æ–‡ä»¶
- **ä½ç½®**: `.github/workflows/daily-full-test.yml`
- **åç§°**: Daily Full Test Suite

### ç¯å¢ƒå˜é‡
- `MAVEN_OPTS`: `-Xmx1024m` (é™åˆ¶ Maven å†…å­˜ä½¿ç”¨)

### å¿…éœ€çš„ Secrets
- `CODECOV_TOKEN`: (å¯é€‰) ç”¨äºä¸Šä¼ è¦†ç›–ç‡åˆ° Codecov
- `GITHUB_TOKEN`: (è‡ªåŠ¨æä¾›) ç”¨äº GraalVM å®‰è£…

## ğŸ“ˆ ç›‘æ§å’Œé€šçŸ¥

### æˆåŠŸæ ‡å‡†
- âœ… æ‰€æœ‰ JavaScript æµ‹è¯•é€šè¿‡
- âœ… æ‰€æœ‰ Java é›†æˆæµ‹è¯•é€šè¿‡
- âœ… å®Œæ•´æµ‹è¯•å¥—ä»¶é€šè¿‡
- âœ… æ²¡æœ‰æ„å»ºé”™è¯¯

### å¤±è´¥å¤„ç†
- âŒ ä»»ä½•æµ‹è¯•å¤±è´¥éƒ½ä¼šæ ‡è®° workflow ä¸ºå¤±è´¥
- ğŸ“§ GitHub ä¼šè‡ªåŠ¨å‘é€é‚®ä»¶é€šçŸ¥ï¼ˆå¦‚å·²é…ç½®ï¼‰
- ğŸ”” å¯é…ç½® Slack/Teams ç­‰é€šçŸ¥ï¼ˆéœ€é¢å¤–é…ç½®ï¼‰

## ğŸ” æŸ¥çœ‹æµ‹è¯•ç»“æœ

### GitHub Actions é¡µé¢
1. è®¿é—® https://github.com/lihongjie0209/sm-js-bc/actions
2. é€‰æ‹© "Daily Full Test Suite" workflow
3. æŸ¥çœ‹æœ€è¿‘çš„è¿è¡Œè®°å½•
4. ç‚¹å‡»å…·ä½“çš„è¿è¡ŒæŸ¥çœ‹è¯¦ç»†æ—¥å¿—

### æµ‹è¯•è¦†ç›–ç‡
- è®¿é—® Codecov ä»ªè¡¨æ¿ï¼ˆå¦‚å·²é…ç½®ï¼‰
- æŸ¥çœ‹ä»£ç è¦†ç›–ç‡è¶‹åŠ¿
- æŸ¥çœ‹æœªè¦†ç›–çš„ä»£ç è¡Œ

## ğŸ› ï¸ æœ¬åœ°æµ‹è¯•

åœ¨æ¨é€å‰å¯ä»¥æœ¬åœ°è¿è¡Œç›¸åŒçš„æµ‹è¯•ï¼š

```bash
# JavaScript æµ‹è¯•
npm test
npm run test:coverage

# æ„å»ºé¡¹ç›®
npm run build

# Java æµ‹è¯•ï¼ˆéœ€è¦ Maven å’Œ JDKï¼‰
cd test/graalvm-integration/java
mvn clean test

# å®Œæ•´æµ‹è¯•å¥—ä»¶
npm run test:all
```

## ğŸ“ æœ€ä½³å®è·µ

1. **æ¨é€å‰æµ‹è¯•**: æ¨é€åˆ° main/master å‰å…ˆè¿è¡Œæœ¬åœ°æµ‹è¯•
2. **æŸ¥çœ‹æŠ¥å‘Š**: å®šæœŸæŸ¥çœ‹æ¯æ—¥æµ‹è¯•æŠ¥å‘Šï¼ŒåŠæ—¶å‘ç°é—®é¢˜
3. **å¿«é€Ÿä¿®å¤**: æµ‹è¯•å¤±è´¥æ—¶å°½å¿«ä¿®å¤ï¼Œé¿å…å½±å“å…¶ä»–å¼€å‘
4. **ä¿æŒæ›´æ–°**: å®šæœŸæ›´æ–°ä¾èµ–å’Œæµ‹è¯•ç¯å¢ƒ

## ğŸ”— ç›¸å…³é“¾æ¥

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [Codecov æ–‡æ¡£](https://docs.codecov.com/)
- [GraalVM æ–‡æ¡£](https://www.graalvm.org/latest/docs/)
- [Maven Surefire æ’ä»¶](https://maven.apache.org/surefire/maven-surefire-plugin/)

## ğŸ¯ æœªæ¥æ”¹è¿›

- [ ] æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] é›†æˆ SonarQube ä»£ç è´¨é‡åˆ†æ
- [ ] æ·»åŠ æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
- [ ] é…ç½® Slack/Teams é€šçŸ¥
- [ ] æ·»åŠ è‡ªåŠ¨å‘å¸ƒæµç¨‹
- [ ] æ·»åŠ ä¾èµ–å®‰å…¨æ‰«æ

## ğŸ’¡ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**Q: æµ‹è¯•è¶…æ—¶äº†æ€ä¹ˆåŠï¼Ÿ**
A: æ£€æŸ¥æ˜¯å¦æœ‰æ­»å¾ªç¯æˆ–æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥å¢åŠ  `timeout-minutes` é…ç½®ã€‚

**Q: Java æµ‹è¯•å¤±è´¥ä½†æœ¬åœ°é€šè¿‡ï¼Ÿ**
A: æ£€æŸ¥ JDK ç‰ˆæœ¬å·®å¼‚ï¼Œç¡®ä¿æœ¬åœ°ä½¿ç”¨çš„ JDK ç‰ˆæœ¬ä¸ CI ä¸€è‡´ã€‚

**Q: è¦†ç›–ç‡ä¸Šä¼ å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥ `CODECOV_TOKEN` æ˜¯å¦æ­£ç¡®é…ç½®ï¼Œæˆ–è€…è®¾ç½® `continue-on-error: true`ã€‚

**Q: å¦‚ä½•è·³è¿‡æŸäº›æµ‹è¯•ï¼Ÿ**
A: å¯ä»¥ä½¿ç”¨ Maven çš„ `-DskipTests` æˆ– Vitest çš„ `--skip` å‚æ•°ã€‚

---

æœ€åæ›´æ–°: 2025-11-05
ç»´æŠ¤è€…: lihongjie0209
