# SM-JS-BC ç¤ºä¾‹ä»£ç 

æœ¬ç›®å½•åŒ…å« `sm-js-bc` åº“çš„æ‰€æœ‰ç¤ºä¾‹ä»£ç ï¼Œä¸ README.md ä¸­çš„ä»£ç ç¤ºä¾‹ä¸€ä¸€å¯¹åº”ã€‚

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ | å¯¹åº” README ç« èŠ‚ |
|------|------|-----------------|
| `sm3-hash.mjs` | SM3 å“ˆå¸Œè®¡ç®—ç¤ºä¾‹ | SM3 å“ˆå¸Œ |
| `hmac-sm3.mjs` | HMAC-SM3 æ¶ˆæ¯è®¤è¯ç ç¤ºä¾‹ | HMAC-SM3 æ¶ˆæ¯è®¤è¯ç  |
| `sm2-keypair.mjs` | SM2 å¯†é’¥å¯¹ç”Ÿæˆç¤ºä¾‹ | SM2 å¯†é’¥å¯¹ç”Ÿæˆ |
| `sm2-sign.mjs` | SM2 æ•°å­—ç­¾åç¤ºä¾‹ | SM2 æ•°å­—ç­¾å |
| `sm2-encrypt.mjs` | SM2 å…¬é’¥åŠ å¯†ç¤ºä¾‹ | SM2 å…¬é’¥åŠ å¯† |
| `sm2-keyexchange.mjs` | SM2 å¯†é’¥äº¤æ¢ç¤ºä¾‹ | SM2 å¯†é’¥äº¤æ¢ |
| `sm4-ecb-simple.mjs` | SM4 ECB æ¨¡å¼ç®€å•ç¤ºä¾‹ | SM4 å¯¹ç§°åŠ å¯† |
| `sm4-modes.mjs` | SM4 å¤šç§å·¥ä½œæ¨¡å¼ç¤ºä¾‹ | SM4 é«˜çº§ç”¨æ³• |
| `zuc-encryption.mjs` | ZUC æµå¯†ç ç¤ºä¾‹ ğŸ†• | ZUC æµå¯†ç  |
| `x509-certificate.mjs` | X.509 è¯ä¹¦ç¤ºä¾‹ | X.509 è¯ä¹¦ |
| `advanced-pki.mjs` | é«˜çº§ PKI ç¤ºä¾‹ | é«˜çº§ PKI |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd example
npm install
```

è¿™å°†å®‰è£…çˆ¶ç›®å½•çš„ `sm-js-bc` åº“ï¼ˆä½¿ç”¨ `file:..` ä¾èµ–ï¼‰ã€‚

### 2. è¿è¡Œç¤ºä¾‹

#### è¿è¡Œå•ä¸ªç¤ºä¾‹

```bash
# SM3 å“ˆå¸Œ
npm run sm3-hash

# HMAC-SM3 æ¶ˆæ¯è®¤è¯ç 
npm run hmac-sm3

# SM2 å¯†é’¥å¯¹ç”Ÿæˆ
npm run sm2-keypair

# SM2 æ•°å­—ç­¾å
npm run sm2-sign

# SM2 å…¬é’¥åŠ å¯†
npm run sm2-encrypt

# SM2 å¯†é’¥äº¤æ¢
npm run sm2-keyexchange

# SM4 ECB æ¨¡å¼ç®€å•ç¤ºä¾‹
npm run sm4-ecb-simple

# SM4 å¤šç§å·¥ä½œæ¨¡å¼ç¤ºä¾‹
npm run sm4-modes

# ZUC æµå¯†ç ç¤ºä¾‹ ğŸ†•
npm run zuc-encryption

# X.509 è¯ä¹¦ç¤ºä¾‹
npm run x509-certificate

# é«˜çº§ PKI ç¤ºä¾‹
npm run advanced-pki
```

#### æˆ–è€…ç›´æ¥ä½¿ç”¨ node å‘½ä»¤

```bash
node sm3-hash.mjs
node hmac-sm3.mjs
node sm2-keypair.mjs
node sm4-ecb-simple.mjs
node sm4-modes.mjs
node sm2-sign.mjs
node sm2-encrypt.mjs
node sm2-keyexchange.mjs
```

#### è¿è¡Œæ‰€æœ‰ç¤ºä¾‹

```bash
npm run all
```

## ğŸ“ ç¤ºä¾‹è¯´æ˜

### SM3 å“ˆå¸Œç¤ºä¾‹ (`sm3-hash.mjs`)

æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ `SM3Digest` ç±»è®¡ç®—æ•°æ®çš„å“ˆå¸Œå€¼ï¼š
- åŸºæœ¬å“ˆå¸Œè®¡ç®—
- åˆ†æ®µæ•°æ®æ›´æ–°
- ç©ºæ•°æ®å“ˆå¸Œ

### HMAC-SM3 æ¶ˆæ¯è®¤è¯ç ç¤ºä¾‹ (`hmac-sm3.mjs`)

æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ `HMac` ç±»ç”Ÿæˆæ¶ˆæ¯è®¤è¯ç ï¼š
- åŸºæœ¬ HMAC è®¡ç®—
- åˆ†æ®µæ›´æ–°æ•°æ®
- é‡ç½®å’Œé‡ç”¨ HMAC å®ä¾‹
- æ¶ˆæ¯éªŒè¯
- ä¸åŒå¯†é’¥é•¿åº¦å¤„ç†

### SM2 å¯†é’¥å¯¹ç”Ÿæˆç¤ºä¾‹ (`sm2-keypair.mjs`)

æ¼”ç¤ºå¦‚ä½•ç”Ÿæˆ SM2 å¯†é’¥å¯¹ï¼š
- ç”Ÿæˆå•ä¸ªå¯†é’¥å¯¹
- æ‰¹é‡ç”Ÿæˆå¤šä¸ªå¯†é’¥å¯¹
- æŸ¥çœ‹å¯†é’¥æ ¼å¼å’Œé•¿åº¦

### SM2 æ•°å­—ç­¾åç¤ºä¾‹ (`sm2-sign.mjs`)

æ¼”ç¤º SM2 æ•°å­—ç­¾åçš„å®Œæ•´æµç¨‹ï¼š
- ç”Ÿæˆå¯†é’¥å¯¹
- å¯¹æ¶ˆæ¯è¿›è¡Œç­¾å
- éªŒè¯ç­¾å
- ç¯¡æ”¹æ¶ˆæ¯åéªŒç­¾ï¼ˆå¤±è´¥ï¼‰
- ä½¿ç”¨é”™è¯¯å…¬é’¥éªŒç­¾ï¼ˆå¤±è´¥ï¼‰
- ç­¾åå¤šæ¡æ¶ˆæ¯

### SM2 å…¬é’¥åŠ å¯†ç¤ºä¾‹ (`sm2-encrypt.mjs`)

æ¼”ç¤º SM2 å…¬é’¥åŠ å¯†/è§£å¯†æµç¨‹ï¼š
- ç”Ÿæˆå¯†é’¥å¯¹
- ä½¿ç”¨å…¬é’¥åŠ å¯†
- ä½¿ç”¨ç§é’¥è§£å¯†
- åŠ å¯†ä¸åŒé•¿åº¦çš„æ¶ˆæ¯
- å¤„ç† UTF-8 å¤šå­—èŠ‚å­—ç¬¦
- ä½¿ç”¨é”™è¯¯ç§é’¥è§£å¯†ï¼ˆå¤±è´¥ï¼‰

### SM2 å¯†é’¥äº¤æ¢ç¤ºä¾‹ (`sm2-keyexchange.mjs`)

æ¼”ç¤º SM2 å¯†é’¥äº¤æ¢åè®®ï¼ˆECDHï¼‰ï¼š
- Alice å’Œ Bob å„è‡ªç”Ÿæˆé™æ€å¯†é’¥å¯¹
- ç”Ÿæˆä¸´æ—¶å¯†é’¥å¯¹
- è®¡ç®—å…±äº«å¯†é’¥
- éªŒè¯åŒæ–¹å¯†é’¥ä¸€è‡´
- ç”Ÿæˆä¸åŒé•¿åº¦çš„å…±äº«å¯†é’¥ï¼ˆ128/192/256ä½ï¼‰

### SM4 ECB æ¨¡å¼ç®€å•ç¤ºä¾‹ (`sm4-ecb-simple.mjs`)

æ¼”ç¤º SM4 å¯¹ç§°åŠ å¯†åŸºæœ¬ç”¨æ³•ï¼ˆECB æ¨¡å¼ï¼‰ï¼š
- ç”Ÿæˆéšæœº 128 ä½å¯†é’¥
- ECB æ¨¡å¼åŠ å¯†/è§£å¯†ï¼ˆPKCS7 å¡«å……ï¼‰
- å¤„ç†ä¸åŒé•¿åº¦çš„æ•°æ®ï¼ˆ0-100 å­—èŠ‚ï¼‰
- å•å—åŠ å¯†ï¼ˆ16 å­—èŠ‚ï¼Œæ— å¡«å……ï¼‰
- âš ï¸ ECB æ¨¡å¼ä¸å®‰å…¨ï¼Œä»…ç”¨äºæ¼”ç¤º

### SM4 å¤šç§å·¥ä½œæ¨¡å¼ç¤ºä¾‹ (`sm4-modes.mjs`)

æ¼”ç¤º SM4 çš„å„ç§å·¥ä½œæ¨¡å¼ï¼š
- ECB æ¨¡å¼ï¼ˆç”µå­å¯†ç æœ¬ï¼‰
- CBC æ¨¡å¼ï¼ˆå¯†ç å—é“¾æ¥ï¼‰
- CTR æ¨¡å¼ï¼ˆè®¡æ•°å™¨æ¨¡å¼ï¼‰
- GCM æ¨¡å¼ï¼ˆè®¤è¯åŠ å¯†ï¼‰
- ä½¿ç”¨åº•å±‚ API ç›´æ¥æ§åˆ¶åŠ å¯†å‚æ•°
- å¯¹æ¯”ä¸åŒæ¨¡å¼çš„ç‰¹æ€§å’Œå®‰å…¨æ€§

## ğŸ¯ é¢„æœŸè¾“å‡º

æ¯ä¸ªç¤ºä¾‹éƒ½ä¼šè¾“å‡ºè¯¦ç»†çš„æ‰§è¡Œè¿‡ç¨‹å’Œç»“æœï¼Œä¾‹å¦‚ï¼š

```
=== SM3 å“ˆå¸Œç¤ºä¾‹ ===

è¾“å…¥æ•°æ®: Hello, SM3!
SM3 Hash: 9b8c9d5b8e7a6f5c4d3e2a1b0c9d8e7f6a5b4c3d2e1f0a9b8c7d6e5f4a3b2c1
å“ˆå¸Œé•¿åº¦: 32 å­—èŠ‚

--- åˆ†æ®µæ›´æ–°ç¤ºä¾‹ ---
åˆ†æ®µè¾“å…¥: "Hello, " + "SM3!"
SM3 Hash: 9b8c9d5b8e7a6f5c4d3e2a1b0c9d8e7f6a5b4c3d2e1f0a9b8c7d6e5f4a3b2c1
ç»“æœä¸€è‡´: true

--- ç©ºæ•°æ®å“ˆå¸Œ ---
ç©ºæ•°æ® Hash: 1ab21d8355cfa17f8e61194831e81a8f22bec8c728fefb747ed035eb5082aa2b

âœ… SM3 å“ˆå¸Œç¤ºä¾‹è¿è¡Œå®Œæˆ
```

## ğŸ”§ è‡ªå®šä¹‰ç¤ºä¾‹

ä½ å¯ä»¥åŸºäºè¿™äº›ç¤ºä¾‹åˆ›å»ºè‡ªå·±çš„ä»£ç ï¼š

1. å¤åˆ¶ä»»æ„ç¤ºä¾‹æ–‡ä»¶
2. ä¿®æ”¹ä»£ç ä»¥é€‚åº”ä½ çš„éœ€æ±‚
3. ä½¿ç”¨ `node your-example.mjs` è¿è¡Œ

## ğŸ“¦ ä¾èµ–è¯´æ˜

æ‰€æœ‰ç¤ºä¾‹éƒ½åªä¾èµ–æ‰“åŒ…åçš„ `sm-js-bc` åº“ï¼Œä¸ä¾èµ–æºä»£ç ï¼š

```json
{
  "dependencies": {
    "sm-js-bc": "file:.."
  }
}
```

è¿™æ„å‘³ç€ï¼š
- âœ… ç¤ºä¾‹ä½¿ç”¨çš„æ˜¯æ„å»ºåçš„ `dist/` æ–‡ä»¶
- âœ… ä¸æœ€ç»ˆç”¨æˆ·çš„ä½¿ç”¨æ–¹å¼å®Œå…¨ä¸€è‡´
- âœ… å¯ä»¥éªŒè¯æ‰“åŒ…åçš„åº“æ˜¯å¦æ­£å¸¸å·¥ä½œ

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç¡®ä¿å·²æ„å»º**ï¼šè¿è¡Œç¤ºä¾‹å‰ï¼Œè¯·å…ˆåœ¨çˆ¶ç›®å½•æ‰§è¡Œ `npm run build` æ„å»ºé¡¹ç›®
2. **Node.js ç‰ˆæœ¬**ï¼šéœ€è¦ Node.js >= 20.0.0ï¼ˆES2020 æ”¯æŒï¼‰
3. **é‡æ–°æ„å»º**ï¼šå¦‚æœä¿®æ”¹äº†æºä»£ç ï¼Œéœ€è¦é‡æ–°æ„å»ºåç¤ºä¾‹æ‰ä¼šç”Ÿæ•ˆ

## ğŸ› é—®é¢˜æ’æŸ¥

### é”™è¯¯ï¼šCannot find package 'sm-js-bc'

**åŸå› **ï¼šæœªå®‰è£…ä¾èµ–æˆ–çˆ¶ç›®å½•æœªæ„å»º

**è§£å†³**ï¼š
```bash
# åœ¨çˆ¶ç›®å½•æ„å»º
cd ..
npm run build

# åœ¨ example ç›®å½•å®‰è£…
cd example
npm install
```

### é”™è¯¯ï¼šModule not found

**åŸå› **ï¼šNode.js ç‰ˆæœ¬è¿‡ä½æˆ–æ¨¡å—å¯¼å…¥è·¯å¾„é”™è¯¯

**è§£å†³**ï¼š
- æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼š`node --version`ï¼ˆéœ€è¦ >= 20.0.0ï¼‰
- ç¡®ä¿ package.json ä¸­æœ‰ `"type": "module"`

## ğŸ“š æ›´å¤šä¿¡æ¯

- [ä¸»é¡¹ç›® README](../README.md)
- [API æ–‡æ¡£](../docs/)
- [æµ‹è¯•ä»£ç ](../test/)

---

å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿æå‡º [Issue](https://github.com/lihongjie0209/sm-js-bc/issues)ï¼
